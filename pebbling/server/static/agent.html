<!DOCTYPE html>
<html lang="en" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agent Information - Pebbling</title>
    <link rel="icon" type="image/x-icon" href="https://pydantic.dev/favicon/favicon-32x32.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        'sans': ['-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'sans-serif'],
                        'mono': ['SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', 'monospace']
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="common.css">
        
        .agent-card-link {
            position: absolute;
            bottom: 1rem;
            right: 1rem;
            font-size: 0.75rem;
        }
        
        .agent-card-link a {
            color: var(--text-muted);
            text-decoration: none;
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', monospace;
            transition: color 0.2s ease;
        }
        
        .agent-card-link a:hover {
            color: var(--accent-primary);
            text-decoration: underline;
        }

        .skill-item {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 0.75rem;
            border-left: 4px solid var(--accent-primary);
            transition: all 0.2s ease;
        }

        .skill-item:hover {
            border-color: var(--border-hover);
            box-shadow: var(--shadow-sm);
        }

        .skill-name {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .skill-description {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 1.5rem;
            color: var(--accent-primary);
        }

        .agent-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .capabilities-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            padding: 1.5rem;
        }

        .capabilities-card h4 {
            color: var(--text-primary);
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .capability-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border-color);
        }

        .capability-item:last-child {
            border-bottom: none;
        }

        .capability-name {
            font-weight: 500;
            color: var(--text-primary);
        }

        .capability-status {
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .capability-status.enabled {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .capability-status.disabled {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error);
        }

        @media (max-width: 768px) {
            .agent-details {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1>ü§ñ Pebbling Agent</h1>
                <p>Agent Information & Capabilities</p>
            </div>
            <div class="header-actions">
                <button id="theme-toggle" class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
                    <!-- Theme icon will be inserted by JavaScript -->
                </button>
                <a href="https://github.com/pydantic/pebble" target="_blank" rel="noopener noreferrer" class="github-link">
                    Pebbling
                </a>
            </div>
        </div>

        <nav class="nav">
            <a href="agent.html" class="active">üìã Agent Info</a>
            <a href="chat.html">üí¨ Chat</a>
            <a href="storage.html">üíæ Storage</a>
            <a href="docs.html">üìö Documentation</a>
        </nav>

        <div class="card">
            <h2>üìã Agent Information</h2>
            <div id="agent-info" class="agent-info">
                <div class="loading">Loading agent information...</div>
            </div>
            <div class="agent-card-link">
                <a href="/.well-known/agent.json" target="_blank" rel="noopener noreferrer">
                    /.well-known/agent.json
                </a>
            </div>
        </div>

        <div class="agent-details" id="agent-details" style="display: none;">
            <div class="card">
                <h2>üõ†Ô∏è Capabilities</h2>
                <div id="capabilities-info" class="capabilities-card">
                    <!-- Capabilities will be loaded here -->
                </div>
            </div>

            <div class="card">
                <h2>üéØ Skills</h2>
                <div id="skills-info">
                    <!-- Skills will be loaded here -->
                </div>
            </div>
        </div>

        <div class="footer">
            <p><strong>üß™ Experimental Feature</strong><br>
            This documentation interface is experimental and under active development.
            We'd love your feedback to make it better! Please share your thoughts and suggestions on
            <a href="https://github.com/pydantic/fasta2a/issues/1" target="_blank" rel="noopener noreferrer">GitHub</a>.</p>
        </div>
    </div>

    <div id="error-container" class="error" style="display: none;"></div>

    <script src="common.js"></script>
    <script>
        let agentCard = null;

        async function loadAndDisplayAgent() {
            try {
                agentCard = await loadAgentCard();
                displayAgentCard();
                displayCapabilities();
                displaySkills();
                document.getElementById('agent-details').style.display = 'grid';
            } catch (error) {
                console.error('Error loading agent card:', error);
                document.getElementById('agent-info').innerHTML =
                    '<div class="error">Failed to load agent information</div>';
                showError('Failed to load agent information: ' + error.message);
            }
        }

        function displayAgentCard() {
            if (!agentCard) return;

            const infoDiv = document.getElementById('agent-info');
            infoDiv.innerHTML = `
                <h3>${agentCard.name}</h3>
                <p>${agentCard.description}</p>

                <div class="info-grid">
                    <div class="info-label">Version:</div>
                    <div class="info-value">${agentCard.version}</div>

                    <div class="info-label">Protocol:</div>
                    <div class="info-value">Pebble v${agentCard.protocolVersion}</div>

                    <div class="info-label">URL:</div>
                    <div class="info-value">${agentCard.url}</div>

                    <div class="info-label">DID:</div>
                    <div class="info-value">${agentCard.did || 'Not available'}</div>

                    <div class="info-label">Created:</div>
                    <div class="info-value">${agentCard.created ? formatTimestamp(agentCard.created) : 'Not available'}</div>
                </div>
            `;
        }

        function displayCapabilities() {
            if (!agentCard || !agentCard.capabilities) return;

            const capabilitiesDiv = document.getElementById('capabilities-info');
            const capabilities = agentCard.capabilities;

            capabilitiesDiv.innerHTML = `
                <h4>Available Capabilities</h4>
                <div class="capability-item">
                    <span class="capability-name">Streaming</span>
                    <span class="capability-status ${capabilities.streaming ? 'enabled' : 'disabled'}">
                        ${capabilities.streaming ? 'Enabled' : 'Disabled'}
                    </span>
                </div>
                <div class="capability-item">
                    <span class="capability-name">Push Notifications</span>
                    <span class="capability-status ${capabilities.pushNotifications ? 'enabled' : 'disabled'}">
                        ${capabilities.pushNotifications ? 'Enabled' : 'Disabled'}
                    </span>
                </div>
                <div class="capability-item">
                    <span class="capability-name">State History</span>
                    <span class="capability-status ${capabilities.stateTransitionHistory ? 'enabled' : 'disabled'}">
                        ${capabilities.stateTransitionHistory ? 'Enabled' : 'Disabled'}
                    </span>
                </div>
                <div class="capability-item">
                    <span class="capability-name">Context Management</span>
                    <span class="capability-status ${capabilities.contextManagement ? 'enabled' : 'disabled'}">
                        ${capabilities.contextManagement ? 'Enabled' : 'Disabled'}
                    </span>
                </div>
            `;
        }

        function displaySkills() {
            if (!agentCard || !agentCard.skills || agentCard.skills.length === 0) {
                document.getElementById('skills-info').innerHTML = 
                    '<p class="info-value">No skills defined for this agent.</p>';
                return;
            }

            const skillsDiv = document.getElementById('skills-info');
            skillsDiv.innerHTML = agentCard.skills.map(skill => `
                <div class="skill-item">
                    <div class="skill-name">${skill.name}</div>
                    <div class="skill-description">${skill.description || 'No description available'}</div>
                </div>
            `).join('');
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', () => {
            setActiveNav('agent.html');
            loadAndDisplayAgent();
        });
    </script>
</body>
</html>
